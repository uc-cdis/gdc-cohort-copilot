# GDC Cohort Copilot

**GDC Cohort Copilot** is an AI copilot tool to assist in the curation of cohorts from the NCI GDC using natural language. We share GDC Cohort Copilot as a containerized Gradio app on HuggingFace Spaces available at: [https://huggingface.co/spaces/uc-ctds/GDC-Cohort-Copilot](https://huggingface.co/spaces/uc-ctds/GDC-Cohort-Copilot).

The implementation of the web app can be found in the git submodule at: [`app`](https://huggingface.co/spaces/uc-ctds/GDC-Cohort-Copilot/tree/main) (links to HuggingFace repo).

### Run Locally

The containerized Gradio app can be run locally using `docker`. The docker image is available at the following URL:
```
registry.hf.space/uc-ctds-gdc-cohort-copilot
```

To run the app locally, run the following before opening `http://localhost:7860` in a web browser:
```bash
docker run -it --rm -p 7860:7860 registry.hf.space/uc-ctds-gdc-cohort-copilot:latest python app.py
```
* The app runs on port `7860` within the container, however if this port is occupied on the host, the port can be remapped on the host using the `p` flag. Refer to the `docker run` documentation on [host/container port mapping](https://docs.docker.com/reference/cli/docker/container/run/#publish) for details.
* If serving remotely, you will need to ssh tunnel from your local to the remote host before being able to open the app in your web browser:
    ```bash
    ssh -NL 7860:localhost:7860 <user>@<remote>
    ```

Model inference may be sped up by using GPU acceleration, though is not required:
```bash
docker run -it --rm -p 7860:7860 --runtime nvidia --gpus all registry.hf.space/uc-ctds-gdc-cohort-copilot:latest python app.py
```
* GPU acceleration requires installing [nvidia-container-toolkit](https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html).
* On multi-GPU hosts, restricting the container to specific GPUs can be controlled with the `--gpus` flag. Please refer to the `docker run` documentation on [accessing GPUs](https://docs.docker.com/reference/cli/docker/container/run/#gpus) for additional details.


# Method

![overview figure](figs/GDC%20Cohort%20Copilot%20Overview.png)

Overview of GDC Cohort Copilot implementation and user workflow:
<ol type="A">
  <li>Implementation of GDC Cohort Copilot involves training the GDC Cohort LLM to translate from a natural language query of a cohort to the cohort filter JSON. The cohort JSONs are derived from datasests of real user-made cohorts or synthetically generated cohorts. The paired natural language queries are generated by a frozen LLM using the cohort JSONs. The final trained GDC Cohort LLM model is served in a containerized Gradio app that exposes a GDC Cohort Builder-like interface running on HuggingFace Spaces.</li>
  <li>A user curates their desired cohort using the GDC Cohort Copilot by:</li>
  <ol type="1">
    <li>Inputting a natural language description of a desired cohort</li>
    <li>which is automatically passed to GDC Cohort LLM.</li>
    <li>The resulting generated cohort filter is automatically populated back into the interface, allowing the user to manually refine their cohort before</li>
    <li>exporting the curated cohort to the NCI GDC.</li>
  </ol>
</ol>

## GDC Cohort LLM

In addition to the containerized application, we also include our source code for developing and evaluating **GDC Cohort LLM**, the generative language model powering the GDC Cohort Copilot. We share all experimental variants of GDC Cohort LLM on huggingface: [https://huggingface.co/uc-ctds](https://huggingface.co/uc-ctds).

In order, the steps for our experiments are:
1. Setup and activate development environment
    ```
    conda env create -f env.yaml
    conda activate cohort
    ```
1. [Data Preprocessing](./data-preprocessing)
1. [Synthetic Data Generation](./data-generation)
1. [Model Training and Inference](./gdc-cohort-llm)
1. [OpenAI Comparison](./openai-prompting)
1. [Evaluation](./evaluation)

# Citation

```
@article{song2025gdc,
  title={GDC Cohort Copilot: An AI Copilot for Curating Cohorts from the Genomic Data Commons},
  author={Song, Steven and Subramanyam, Anirudh and Zhang, Zhenyu and Venkat, Aarti and Grossman, Robert L},
  journal={arXiv preprint arXiv:2507.02221},
  year={2025}
}
```
